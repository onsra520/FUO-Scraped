<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Viewer - {{ thread_name }}</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <a href="/" style="color: inherit; text-decoration: none;">
                    <i class="fas fa-spider"></i>
                    <span>FUO Phake</span>
                </a>
            </div>
            <div class="nav-title">
                <span>{{ thread_name }}</span>
            </div>
            <div class="nav-actions">
                <a href="/" class="nav-button">
                    <i class="fas fa-home"></i>
                </a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="viewer-content">
        <!-- View Mode Toggle -->
        <div class="viewer-controls">
            <div class="viewer-left-controls">
                <button id="exportPdfBtn" class="control-btn export-btn">
                    <i class="fas fa-file-export"></i>
                    <span>Export PDF</span>
                </button>
            </div>
            
            <div class="viewer-center-controls">
                <button id="prevBtn" class="viewer-btn">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <span id="imageCounter" class="image-counter">1 / 1</span>
                <button id="nextBtn" class="viewer-btn">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            
            <div class="viewer-right-controls">
                <button id="fullscreenBtn" class="icon-btn fullscreen-btn" onclick="toggleFullscreen()" title="Fullscreen">
                    <i class="fas fa-expand"></i>
                </button>
                <button id="viewerSettingsBtn" class="icon-btn settings-btn" onclick="openViewerSettings()" title="Settings">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        </div>

        <!-- Images View -->
        <div id="imagesView" class="images-view">
            <div class="image-container">
                <img id="currentImage" src="" alt="Current Image">
            </div>
        </div>

        <!-- PDF View -->
        <div id="pdfView" class="pdf-view" style="display: none;">
            <iframe id="pdfFrame" src="" frameborder="0"></iframe>
        </div>

        <!-- Loading State -->
        <div id="loadingState" class="loading-state">
            <div class="spinner"></div>
            <p>Đang tải...</p>
        </div>

        <!-- Error State -->
        <div id="errorState" class="error-state" style="display: none;">
            <i class="fas fa-exclamation-circle"></i>
            <h3>Không tìm thấy dữ liệu</h3>
            <p>Thread này chưa có ảnh hoặc PDF.</p>
            <a href="/" class="btn-back">
                <i class="fas fa-arrow-left"></i>
                Về trang chủ
            </a>
        </div>
    </main>

    <!-- Fullscreen Image Overlay -->
    <div id="fullscreenOverlay" class="fullscreen-overlay" style="display: none;">
        <button class="fullscreen-close" onclick="closeImageFullscreen()">
            <i class="fas fa-times"></i>
        </button>
        <button class="fullscreen-nav fullscreen-prev" onclick="fullscreenPrevImage()">
            <i class="fas fa-chevron-left"></i>
        </button>
        <button class="fullscreen-nav fullscreen-next" onclick="fullscreenNextImage()">
            <i class="fas fa-chevron-right"></i>
        </button>
        <div id="fullscreenContent" class="fullscreen-content">
            <img id="fullscreenImage" src="" alt="Fullscreen Image">
        </div>
        <div class="fullscreen-counter" id="fullscreenCounter">1 / 1</div>
    </div>

    <!-- Viewer Settings Modal -->
    <div id="viewerSettingsModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>
                    <i class="fas fa-cog"></i>
                    Viewer Settings
                </h3>
                <button class="modal-close" onclick="closeViewerSettings()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h4 class="settings-section-title">
                        <i class="fas fa-layout"></i>
                        Layout Mode
                    </h4>
                    <div class="layout-grid">
                        <div class="layout-option" data-layout="one-by-one">
                            <div class="layout-preview">
                                <i class="fas fa-square"></i>
                            </div>
                            <div class="layout-info">
                                <strong>One by One</strong>
                                <small>Xem từng ảnh một</small>
                            </div>
                        </div>
                        
                        <div class="layout-option" data-layout="scroll">
                            <div class="layout-preview">
                                <i class="fas fa-grip-vertical"></i>
                            </div>
                            <div class="layout-info">
                                <strong>Scroll</strong>
                                <small>Hiện tất cả để scroll</small>
                            </div>
                        </div>
                        
                        <div class="layout-option" data-layout="grid">
                            <div class="layout-preview">
                                <i class="fas fa-th"></i>
                            </div>
                            <div class="layout-info">
                                <strong>Grid</strong>
                                <small>Lưới 2-3 cột</small>
                            </div>
                        </div>
                        
                        <div class="layout-option" data-layout="slideshow">
                            <div class="layout-preview">
                                <i class="fas fa-play-circle"></i>
                            </div>
                            <div class="layout-info">
                                <strong>Slideshow</strong>
                                <small>Tự động chuyển ảnh</small>
                            </div>
                        </div>
                        
                        <div class="layout-option" data-layout="compare">
                            <div class="layout-preview">
                                <i class="fas fa-columns"></i>
                            </div>
                            <div class="layout-info">
                                <strong>Compare</strong>
                                <small>So sánh 2 ảnh cạnh nhau</small>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="settings-section" id="slideshowSettings" style="display: none;">
                    <h4 class="settings-section-title">
                        <i class="fas fa-clock"></i>
                        Slideshow Settings
                    </h4>
                    <div class="modal-setting-item">
                        <div class="setting-label">
                            <strong>Interval (giây)</strong>
                            <small>Thời gian giữa mỗi slide</small>
                        </div>
                        <input type="number" id="slideshowInterval" class="setting-input" min="1" max="10" value="3">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const courseCode = "{{ course_code }}";
        const threadName = "{{ thread_name }}";
    </script>
    <script src="/static/js/viewer.js?v=5.0"></script>
</body>
</html>
